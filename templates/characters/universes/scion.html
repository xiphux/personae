{% extends "characters/basesheet.html" %}
{% load characters_utils %}

{% block universecss %}
<link rel="stylesheet" href="{{ MEDIA_URL }}characters/css/universe/scion.css">
{% endblock %}

{% block universejs %}
<script type="text/javascript" src="{{ MEDIA_URL }}characters/js/universe/scion.js"></script>
{% endblock %}

{% block header %}
<h1 class="sectionheader">Scion</h1>
{% endblock %}

{% block sheet %}

{% if editmode %}
<script type="text/javascript">
  $(document).ready(function() {
    setupDynamicTables();
  });
</script>
{% endif %}

<div id="basicinfo">

  <div id="basicinfoleft" class="threecolumnleft">

    <table class="fullwidth">
    
      <tr>
        <td class="lightunderline">
          {{ character.name }}
        </td>
      </tr>

      <tr>
        <td class="basicinfolabel">
          <label>Name</label>
        </td>
      </tr>
      
      <tr>
        <td class="lightunderline basicinfolowerrow">
          {% if character.user.first_name or character.user.last_name %}
	    {{ character.user.first_name }} {{ character.user.last_name }}
          {% else %}
            {{ character.user.username }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td class="basicinfolabel">
          <label for="player">Player</label>
        </td>
      </tr>

    </table>

  </div>

  <div id="basicinfomiddle" class="threecolumnmiddle">

    <table class="fullwidth">

      <tr>
        <td class="lightunderline">
          {% if editmode %}
            <input type="text" name="calling" value="{{ attributes.calling.value }}" />
          {% else %}
            {{ attributes.calling }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td class="basicinfolabel">
          <label for="calling">{{ universe_attributes.calling.name }}</label>
        </td>
      </tr>

      <tr>
        <td class="lightunderline basicinfolowerrow">
          {% if editmode %}
            <select name="nature">
        <option value="0"></option>
        {% for choice in universe_attributes.nature.choices %}
          <option value="{{ choice.id }}" {% ifequal choice attributes.nature.choice %}selected{%endifequal %}>{{ choice.name }}</option>
        {% endfor %}
      </select>
          {% else %}
            {{ attributes.nature.choice.name }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td class="basicinfolabel">
          <label for="nature">{{ universe_attributes.nature.name }}</label>
        </td>
      </tr>

    </table>

  </div>

  <div id="basicinforight" class="threecolumnright">

    <table class="fullwidth">

      <tr>
        <td class="lightunderline">
          {% if editmode %}
            <select name="pantheon">
        <option value="0"></option>
        {% for choice in universe_attributes.pantheon.choices %}
          <option value="{{ choice.id }}" {% ifequal choice attributes.pantheon.choice %}selected{% endifequal %}>{{ choice.name }}</option>
        {% endfor %}
      </select>
          {% else %}
            {{ attributes.pantheon.choice.name }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td class="basicinfolabel">
          <label for="pantheon">{{ universe_attributes.pantheon.name }}</label>
        </td>
      </tr>

      <tr>
        <td class="lightunderline basicinfolowerrow">
          {% if editmode %}
            <input type="text" name="god" value="{{ attributes.god }}" />
          {% else %}
            {{ attributes.god }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td class="basicinfolabel">
          <label for="god">{{ universe_attributes.god.name }}</label>
        </td>
      </tr>

    </table>

  </div>

  <div class="clear">&nbsp;</div>

</div>

<div id="attributes">

  <h2 class="sectionheader">Attributes</h2>

  <div id="physicalattributes" class="threecolumnleft">

    <h3 class="textcenter">Physical</h3>

    <table>

      <tr>
        <td rowspan="2" class="fullwidth">
          <div class="attributelabel">{{ universe_attributes.strength.name }}</div>
        </td>
        <td>
          {% if editmode %}
            {% dotselect "strength" %}
          {% else %}
            {{ attributes.strength.value|dots:universe_attributes.strength.max }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td>
          {% if editmode %}
            {% dotselect "epicstrength" "square" %}
          {% else %}
            {{ attributes.epicstrength|squares:universe_attributes.epicstrength.max }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td rowspan="2" class="fullwidth">
          <div class="attributelabel">{{ universe_attributes.dexterity.name }}</div>
        </td>
        <td>
          {% if editmode %}
            {% dotselect "dexterity" %}
          {% else %}
            {{ attributes.dexterity.value|dots:universe_attributes.dexterity.max }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td>
          {% if editmode %}
            {% dotselect "epicdexterity" "square" %}
          {% else %}
            {{ attributes.epicdexterity|squares:universe_attributes.epicdexterity.max }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td rowspan="2" class="fullwidth">
          <div class="attributelabel">{{ universe_attributes.stamina.name }}</div>
        </td>
        <td>
          {% if editmode %}
            {% dotselect "stamina" %}
          {% else %}
            {{ attributes.stamina.value|dots:universe_attributes.stamina.max }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td>
          {% if editmode %}
            {% dotselect "epicstamina" "square" %}
          {% else %}
            {{ attributes.epicstamina|squares:universe_attributes.epicstamina.max }}
          {% endif %}
        </td>
      </tr>

    </table>

  </div>
  
  <div id="socialattributes" class="threecolumnmiddle">

    <h3 class="textcenter">Social</h3>

    <table>

      <tr>
        <td rowspan="2" class="fullwidth">
          <div class="attributelabel">{{ universe_attributes.charisma.name }}</div>
        </td>
        <td>
          {% if editmode %}
            {% dotselect "charisma" %}
          {% else %}
            {{ attributes.charisma.value|dots:universe_attributes.charisma.max }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td>
          {% if editmode %}
            {% dotselect "epiccharisma" "square" %}
          {% else %}
            {{ attributes.epiccharisma|squares:universe_attributes.epiccharisma.max }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td rowspan="2" class="fullwidth">
          <div class="attributelabel">{{ universe_attributes.manipulation.name }}</div>
        </td>
        <td>
          {% if editmode %}
	          {% dotselect "manipulation" %}
          {% else %}
            {{ attributes.manipulation.value|dots:universe_attributes.manipulation.max }}
          {% endif %}
        </td>
      </tr>
      
      <tr>
        <td>
          {% if editmode %}
            {% dotselect "epicmanipulation" "square" %}
          {% else %}
            {{ attributes.epicmanipulation|squares:universe_attributes.epicmanipulation.max }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td rowspan="2" class="fullwidth">
          <div class="attributelabel">{{ universe_attributes.appearance.name }}</div>
        </td>
        <td>
          {% if editmode %}
            {% dotselect "appearance" %}
          {% else %}
            {{ attributes.appearance.value|dots:universe_attributes.appearance.max }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td>
          {% if editmode %}
            {% dotselect "epicappearance" "square" %}
          {% else %}
            {{ attributes.epicappearance|squares:universe_attributes.epicappearance.max }}
          {% endif %}
        </td>
      </tr>

    </table>

  </div>

  <div id="mentalattributes" class="threecolumnright">

    <h3 class="textcenter">Mental</h3>

    <table>

      <tr>
        <td rowspan="2" class="fullwidth">
          <div class="attributelabel">{{ universe_attributes.perception.name }}</div>
        </td>
        <td>
          {% if editmode %}
            {% dotselect "perception" %}
          {% else %}
            {{ attributes.perception.value|dots:universe_attributes.perception.max }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td>
          {% if editmode %}
            {% dotselect "epicperception" "square" %}
          {% else %}
            {{ attributes.epicperception|squares:universe_attributes.epicperception.max }}
          {% endif %}
        </td>
      </tr>
      
      <tr>
        <td rowspan="2" class="fullwidth">
          <div class="attributelabel">{{ universe_attributes.intelligence.name }}</div>
        </td>
        <td>
          {% if editmode %}
            {% dotselect "intelligence" %}
          {% else %}
            {{ attributes.intelligence.value|dots:universe_attributes.intelligence.max }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td>
          {% if editmode %}
            {% dotselect "epicintelligence" "square" %}
          {% else %}
            {{ attributes.epicintelligence|squares:universe_attributes.epicintelligence.max }}
          {% endif %}
        </td>
      </tr>
      
      <tr>
        <td rowspan="2" class="fullwidth">
          <div class="attributelabel">{{ universe_attributes.wits.name }}</div>
        </td>
        <td>
          {% if editmode %}
            {% dotselect "wits" %}
          {% else %}
            {{ attributes.wits.value|dots:universe_attributes.wits.max }}
          {% endif %}
        </td>
      </tr>

      <tr>
        <td>
          {% if editmode %}
            {% dotselect "epicwits" "square" %}
          {% else %}
            {{ attributes.epicwits|squares:universe_attributes.epicwits.max }}
          {% endif %}
        </td>
      </tr>

    </table>

  </div>

  <div class="clear">&nbsp;</div>

</div>

<div id="abilities">

  <h2 class="sectionheader">Abilities</h2>

  <div id="abilitiesleft" class="threecolumnleft">

    <table>

      <tbody>

        <tr>
          <td class="lightunderline">
            <label for="academics">{{ universe_attributes.academics.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="academicsspecialty" value="{{ attributes.academicsspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.academicsspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "academics" %}
            {% else %}
              {{ attributes.academics.value|dots:universe_attributes.academics.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="animalken">{{ universe_attributes.animalken.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="animalkenspecialty" value="{{ attributes.animalkenspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.animalkenspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "animalken" %}
            {% else %}
              {{ attributes.animalken.value|dots:universe_attributes.animalken.max }}
            {% endif %}
          </td>
        </tr>

      </tbody>

      {% if editmode %}
        <tbody>
          <tr>
            <td colspan="2">
              <a class="nounderline" href="#" onclick="addFieldRow('#art0','#artrows',true); return false;">Add art specialty</a>
            </td>
          </tr>
        </tbody>
      {% endif %}

      <tbody id="artrows">

        {% for num, art in attributes.art.items %}

          <tr>

            <td class="lightunderline">
              {{ universe_attributes.art.name }}
            </td>

            <td class="fullwidth lightunderline">

              {% if editmode %}

                <select name="artspecialty">
                  <option value="0"></option>
                  {% for choice in universe_attributes.artspecialty.choices %}
                    <option value="{{ choice.id }}" {% ifequal choice art.artspecialty.choice %}selected{% endifequal %}>{{ choice.name }}</option>
                  {% endfor %}
                </select>

              {% else %}

                {{ art.artspecialty }}

              {% endif %}

            </td>

            <td>
              {% if editmode %}
                {% dotselect "artlevel" "dot" art %}
              {% else %}
                {{ art.artlevel|dots:universe_attributes.artlevel.max }}
              {% endif %}
            </td>
            
            {% if editmode %}
              <td class="removerow">
                <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
              </td>
            {% endif %}

          </tr>

        {% empty %}

          {% if not editmode %}          
            <tr>

              <td class="lightunderline">
                {{ universe_attributes.art.name }}
              </td>

              <td class="fullwidth lightunderline">
              </td>

              <td>
                {{ 0|dots:universe_attributes.artlevel.max }}
              </td>
              
            </tr>
          {% endif %}

        {% endfor %}

      </tbody>

      {% if editmode %}

        <tbody>

          <tr id="art0">

            <td class="lightunderline">
              {{ universe_attributes.art.name }}
            </td>

            <td class="fullwidth lightunderline">
              <select name="artspecialty">
                <option value="0"></option>
                {% for choice in universe_attributes.artspecialty.choices %}
                  <option value="{{ choice.id }}">{{ choice.name }}</option>
                {% endfor %}
              </select>
            </td>

            <td>
              {% dotselect "artlevel" %}
            </td>

            <td class="removerow">
              <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
            </td>

          </tr>

        </tbody>

      {% endif %}

      <tbody>

        <tr>
          <td class="lightunderline">
            <label for="athletics">{{ universe_attributes.athletics.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="athleticsspecialty" value="{{ attributes.athleticsspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.athleticsspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "athletics" %}
            {% else %}
              {{ attributes.athletics.value|dots:universe_attributes.athletics.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="awareness">{{ universe_attributes.awareness.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="awarenessspecialty" value="{{ attributes.awarenessspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.awarenessspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "awareness" %}
            {% else %}
              {{ attributes.awareness.value|dots:universe_attributes.awareness.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="brawl">{{ universe_attributes.brawl.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="brawlspecialty" value="{{ attributes.brawlspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.brawlspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "brawl" %}
            {% else %}
              {{ attributes.brawl.value|dots:universe_attributes.brawl.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="command">{{ universe_attributes.command.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="commandspecialty" value="{{ attributes.commandspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.commandspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "command" %}
            {% else %}
              {{ attributes.command.value|dots:universe_attributes.command.max }}
            {% endif %}
          </td>
        </tr>

      </tbody>

      {% if editmode %}

        <tbody>
          <tr>
            <td colspan="2">
              <a class="nounderline" href="#" onclick="addFieldRow('#control0','#controlrows',true); return false;">Add control specialty</a>
            </td>
          </tr>
        </tbody>

      {% endif %}

      <tbody id="controlrows">

        {% for num, control in attributes.control.items %}

          <tr>

            <td class="lightunderline">
              {{ universe_attributes.control.name }}
            </td>

            <td class="fullwidth lightunderline">

              {% if editmode %}

                <select name="controlspecialty">
                  <option value="0"></option>
                  {% for choice in universe_attributes.controlspecialty.choices %}
                    <option value="{{ choice.id }}" {% ifequal choice control.controlspecialty.choice %}selected{% endifequal %}>{{ choice.name }}</option>
                  {% endfor %}
                </select>

              {% else %}
               
                {{ control.controlspecialty }}

              {% endif %}

            </td>

            <td>
              {% if editmode %}
                {% dotselect "controllevel" "dot" control %}
              {% else %}
                {{ control.controllevel|dots:universe_attributes.controllevel.max }}
              {% endif %}
            </td>

            {% if editmode %}
              <td class="removerow">
                <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
              </td>
            {% endif %}
          
          </tr>

        {% empty %}

          {% if not editmode %}
            <tr>

              <td class="lightunderline">
                {{ universe_attributes.control.name }}
              </td>

              <td class="fullwidth lightunderline">
              </td>

              <td>
                {{ 0|dots:universe_attributes.controllevel.max }}
              </td>

            </tr>
          {% endif %}
        
        {% endfor %}

      </tbody>

      {% if editmode %}

        <tbody>

          <tr id="control0">

            <td class="lightunderline">
              {{ universe_attributes.control.name }}
            </td>

            <td class="fullwidth lightunderline">
              <select name="controlspecialty">
                <option value="0"></option>
                {% for choice in universe_attributes.controlspecialty.choices %}
                  <option value="{{ choice.id }}">{{ choice.name }}</option>
                {% endfor %}
              </select>
            </td>

            <td>
              {% dotselect "controllevel" %}
            </td>

            <td class="removerow">
              <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
            </td>

          </tr>

        </tbody>

      {% endif %}

    </table>

  </div>

  <div id="abilitiesmiddle" class="threecolumnmiddle">

    <table>

      <tbody>

        <tr>
          <td class="lightunderline">
            <label for="craft">{{ universe_attributes.craft.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
          </td>
          <td>
            {% if editmode %}
              {% dotselect "craft" %}
            {% else %}
              {{ attributes.craft.value|dots:universe_attributes.craft.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="empathy">{{ universe_attributes.empathy.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="empathyspecialty" value="{{ attributes.empathyspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.empathyspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "empathy" %}
            {% else %}
              {{ attributes.empathy.value|dots:universe_attributes.empathy.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="fortitude">{{ universe_attributes.fortitude.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="fortitudespecialty" value="{{ attributes.fortitudespecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.fortitudespecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "fortitude" %}
            {% else %}
              {{ attributes.fortitude.value|dots:universe_attributes.fortitude.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="integrity">{{ universe_attributes.integrity.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="integrityspecialty" value="{{ attributes.integrityspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.integrityspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "integrity" %}
            {% else %}
              {{ attributes.integrity.value|dots:universe_attributes.integrity.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="investigation">{{ universe_attributes.investigation.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="investigationspecialty" value="{{ attributes.investigationspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.investigationspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "investigation" %}
            {% else %}
              {{ attributes.investigation.value|dots:universe_attributes.investigation.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="larceny">{{ universe_attributes.larceny.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="larcenyspecialty" value="{{ attributes.larcenyspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.larcenyspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "larceny" %}
            {% else %}
              {{ attributes.larceny.value|dots:universe_attributes.larceny.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="marksmanship">{{ universe_attributes.marksmanship.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="marksmanshipspecialty" value="{{ attributes.marksmanshipspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.marksmanshipspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "marksmanship" %}
            {% else %}
              {{ attributes.marksmanship.value|dots:universe_attributes.marksmanship.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="medicine">{{ universe_attributes.medicine.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="medicinespecialty" value="{{ attributes.medicinespecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.medicinespecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "medicine" %}
            {% else %}
              {{ attributes.medicine.value|dots:universe_attributes.medicine.max }}
            {% endif %}
          </td>
        </tr>

      </tbody>

    </table>

  </div>

  <div id="abilitiesright" class="threecolumnright">

    <table>

      <tbody>

        <tr>
          <td class="lightunderline">
            <label for="melee">{{ universe_attributes.melee.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="meleespecialty" value="{{ attributes.meleespecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.meleespecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "melee" %}
            {% else %}
              {{ attributes.melee.value|dots:universe_attributes.melee.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="occult">{{ universe_attributes.occult.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="occultspecialty" value="{{ attributes.occultspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.occultspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "occult" %}
            {% else %}
              {{ attributes.occult.value|dots:universe_attributes.occult.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="politics">{{ universe_attributes.politics.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="politicsspecialty" value="{{ attributes.politicsspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.politicsspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "politics" %}
            {% else %}
              {{ attributes.politics.value|dots:universe_attributes.politics.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="presence">{{ universe_attributes.presence.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="presencespecialty" value="{{ attributes.presencespecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.presencespecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "presence" %}
            {% else %}
              {{ attributes.presence.value|dots:universe_attributes.presence.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="science">{{ universe_attributes.science.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
          </td>
          <td>
            {% if editmode %}
              {% dotselect "science" %}
            {% else %}
              {{ attributes.science.value|dots:universe_attributes.science.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="stealth">{{ universe_attributes.stealth.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="stealthspecialty" value="{{ attributes.stealthspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.stealthspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "stealth" %}
            {% else %}
              {{ attributes.stealth.value|dots:universe_attributes.stealth.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="survival">{{ universe_attributes.survival.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="survivalspecialty" value="{{ attributes.survivalspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.survivalspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "survival" %}
            {% else %}
              {{ attributes.survival.value|dots:universe_attributes.survival.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td class="lightunderline">
            <label for="thrown">{{ universe_attributes.thrown.name }}</label>
          </td>
          <td class="fullwidth lightunderline">
            {% if editmode %}
              <input type="text" name="thrownspecialty" value="{{ attributes.thrownspecialty }}" class="fullwidth" />
            {% else %}
              {{ attributes.thrownspecialty }}
            {% endif %}
          </td>
          <td>
            {% if editmode %}
              {% dotselect "thrown" %}
            {% else %}
              {{ attributes.thrown.value|dots:universe_attributes.thrown.max }}
            {% endif %}
          </td>
        </tr>

      </tbody>

    </table>

  </div>

  <div class="clear">&nbsp;</div>

</div>

<div>

  <div id="birthrights" class="twocolumnleft">

    <h2 class="sectionheader">{{ universe_attributes.birthrights.name }}</h2>

    {% if editmode %}

      <a class="nounderline" href="#" onclick="addFieldRow('#birthright0','#birthrightsrows',true); return false;">Add birthright</a>

      <table>

        <tbody id="birthrightsrows">

          {% for num, birthright in attributes.birthrights.items %}

            <tr>

              <td class="fullwidth">
                <input type="text" name="birthrightname" value="{{ birthright.birthrightname }}" class="fullwidth" />
              </td>

              <td>
	      	{% dotselect "birthrightlevel" "dot" birthright %}
              </td>

              <td class="removerow">
                <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
              </td>

            </tr>

          {% endfor %}

	</tbody>

	<tbody>

          <tr id="birthright0">

            <td class="fullwidth">
              <input type="text" name="birthrightname" class="fullwidth" />
            </td>

            <td>
	      {% dotselect "birthrightlevel" %}
            </td>

            <td class="removerow">
              <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
            </td>

          </tr>

        </tbody>

      </table>

    {% else %}

      <table class="fullwidth">

        {% for num, birthright in attributes.birthrights.items %}

          <tr>
            <td class="fullwidth lightunderline">{{ birthright.birthrightname }}</td>
            <td>{{ birthright.birthrightlevel.value|dots:universe_attributes.birthrightlevel.max }}</td>
          </tr>

	{% empty %}

	  <tr>
	    <td class="fullwidth emptymessage">No birthrights</td>
	  </tr>

        {% endfor %}

      </table>

    {% endif %}

  </div>

  <div id="weapons" class="twocolumnright">

    <h2 class="sectionheader">{{ universe_attributes.weapons.name }}</h2>

    {% if editmode %}

      <a class="nounderline" href="#" onclick="addFieldRow('#weapon0','#weapontablerows',true); return false;">Add weapon</a>

      <table id="weapontable">

        <thead>

          <tr>
            <th class="fullwidth weaponname">{{ universe_attributes.weaponname.name }}</th>
            <th class="textcenter weaponattributeedit">{{ universe_attributes.weaponspeed.name }}</th>
            <th class="textcenter weaponattributeedit">{{ universe_attributes.weaponaccuracy.name }}</th>
            <th class="textcenter weaponattributeedit">{{ universe_attributes.weapondamage.name }}</th>
            <th class="textcenter weaponattributeedit">{{ universe_attributes.weapondefense.name }}</th>
            <th class="textcenter weaponattributeedit">{{ universe_attributes.weaponrange.name }}</th>
            <th class="removerow"></th>
          </tr>

        </thead>

        <tbody id="weapontablerows">

          {% for num, weapon in attributes.weapons.items %}

            <tr>

              <td class="fullwidth weaponname">
                <input type="text" name="weaponname" value="{{ weapon.weaponname }}" class="fullwidth" />
              </td>

              <td class="textcenter weaponattributeedit">
                <input type="text" name="weaponspeed" value="{{ weapon.weaponspeed }}" class="statfield" />
              </td>

              <td class="textcenter weaponattributeedit">
                <input type="text" name="weaponaccuracy" value="{{ weapon.weaponaccuracy }}" class="statfield" />
              </td>

              <td class="textcenter weaponattributeedit">
                <input type="text" name="weapondamage" value="{{ weapon.weapondamage }}" class="statfield" />
              </td>

              <td class="textcenter weaponattributeedit">
                <input type="text" name="weapondefense" value="{{ weapon.weapondefense }}" class="statfield" />
              </td>

              <td class="textcenter weaponattributeedit">
                <input type="text" name="weaponrange" value="{{ weapon.weaponrange }}" class="statfield" />
              </td>

              <td class="removerow">
                <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
              </td>

            </tr>
            
          {% endfor %}
	
	</tbody>

	<tbody>

          <tr id="weapon0">

            <td class="fullwidth weaponname">
              <input type="text" name="weaponname" class="fullwidth" />
            </td>

            <td class="textcenter weaponattributeedit">
              <input type="text" name="weaponspeed" class="statfield" />
            </td>

            <td class="textcenter weaponattributeedit">
              <input type="text" name="weaponaccuracy" class="statfield" />
            </td>

            <td class="textcenter weaponattributeedit">
              <input type="text" name="weapondamage" class="statfield" />
            </td>

            <td class="textcenter weaponattributeedit">
              <input type="text" name="weapondefense" class="statfield" />
            </td>

            <td class="textcenter weaponattributeedit">
              <input type="text" name="weaponrange" class="statfield" />
            </td>

            <td class="removerow">
              <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
            </td>

          </tr>

        </tbody>

      </table>

    {% else %}

      <table id="weapontable" class="fullwidth">

        {% for num, weapon in attributes.weapons.items %}

          {% if forloop.first %}

            <tr>
              <th class="fullwidth weaponname">{{ universe_attributes.weaponname.name }}</th>
              <th class="textcenter weaponattribute">{{ universe_attributes.weaponspeed.name }}</th>
              <th class="textcenter weaponattribute">{{ universe_attributes.weaponaccuracy.name }}</th>
              <th class="textcenter weaponattribute">{{ universe_attributes.weapondamage.name }}</th>
              <th class="textcenter weaponattribute">{{ universe_attributes.weapondefense.name }}</th>
              <th class="textcenter weaponattribute">{{ universe_attributes.weaponrange.name }}</th>
            </tr>

          {% endif %}

          <tr>
            <td class="fullwidth lightunderline">{{ weapon.weaponname }}</td>
            <td class="lightunderline textcenter weaponattribute">{{ weapon.weaponspeed }}</td>
            <td class="lightunderline textcenter weaponattribute">{{ weapon.weaponaccuracy }}</td>
            <td class="lightunderline textcenter weaponattribute">{{ weapon.weapondamage }}</td>
            <td class="lightunderline textcenter weaponattribute">{{ weapon.weapondefense }}</td>
            <td class="lightunderline textcenter weaponattribute">{{ weapon.weaponrange }}</td>
          </tr>

        {% empty %}

          <tr>
            <td class="fullwidth emptymessage">No weapons</td>
          </tr>

        {% endfor %}

      </table>

    {% endif %}

  </div>

  <div class="clear">&nbsp;</div>

</div>

<div>

  <div id="willpowercombat" class="twocolumnleft">

    <div id="willpower">

      <h2 class="sectionheader">Willpower</h2>

      <table class="tablecenter">

        <tr>
          <td>
            {% if editmode %}
              {% dotselect "willpowermax" %}
            {% else %}
              {{ attributes.willpowermax|dots:universe_attributes.willpowermax.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td>
            {% if editmode %}
              {% dotselect "willpowercurrent" "square" %}
            {% else %}
              {{ attributes.willpowercurrent|squares:universe_attributes.willpowercurrent.max }}
            {% endif %}
          </td>
        </tr>

      </table>

    </div>

    <div id="combat">

      <h2 class="sectionheader">Combat</h2>

      <table class="tablecenter">

        <tr>
          <td>
            <label for="dodgedv">{{ universe_attributes.dodgedv.name }}:<label>
          </td>
          <td>
            {% if editmode %}
              <input type="text" name="dodgedv" value="{{ attributes.dodgedv }}" />
            {% else %}
              {{ attributes.dodgedv }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td>
            <label for="parrydv">{{ universe_attributes.parrydv.name }}:</label>
          </td>
          <td>
            {% if editmode %}
              <input type="text" name="parrydv" value="{{ attributes.parrydv }}" />
            {% else %}
              {{ attributes.parrydv }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td>
            <label for="joinbattle">{{ universe_attributes.joinbattle.name }}:</label>
          </td>
          <td>
            {% if editmode %}
              <input type="text" name="joinbattle" value="{{ attributes.joinbattle }}" />
            {% else %}
              {{ attributes.joinbattle }}
            {% endif %}
          </td>
        </tr>

      </table>

    </div>
  
  </div>

  <div id="virtues" class="twocolumnright">

    <h2 class="sectionheader">{{ universe_attributes.virtues.name }}</h2>

    {% if editmode %}

      <a class="nounderline" href="#" onclick="addFieldRow('#virtue0','#virtuerows',true); return false;">Add virtue</a>

      <table id="virtuetable">

        <tbody id="virtuerows">

          {% for num, virtue in attributes.virtues.items %}

            <tr>

              <td class="fullwidth">
                <div class="lightunderline">
                  <select name="virtue">
                    <option value="0"></option>
                    {% for choice in universe_attributes.virtue.choices %}
                      <option value="{{ choice.id }}" {% ifequal choice virtue.virtue.choice %}selected{% endifequal %}>{{ choice.name }}</option>
                    {% endfor %}
                  </select>
                </div>
              </td>
              <td>
	      	{% dotselect "virtuelevel" "dot" virtue %}
		{% dotselect "virtueboost" "square" virtue %}
              </td>
              <td class="removerow">
                <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
              </td>
            
            </tr>

          {% endfor %}

        </tbody>

	<tbody>

          <tr id="virtue0">
            
            <td class="fullwidth">
              <div class="lightunderline">
                <select name="virtue">
                  <option value="0"></option>
                  {% for choice in universe_attributes.virtue.choices %}
                    <option value="{{ choice.id }}" >{{ choice.name }}</option>
                  {% endfor %}
                </select>
              </div>
            </td>
            <td>
	      {% dotselect "virtuelevel" %}
	      {% dotselect "virtueboost" "square" %}
            </td>
            <td class="removerow">
              <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
            </td>

          </tr>

        </tbody>

      </table>

    {% else %}

      <table class="fullwidth" id="virtuetable">

        {% for num, virtue in attributes.virtues.items %}

          <tr>
            <td class="fullwidth" rowspan="2"><div class="lightunderline fullwidth">{{ virtue.virtue }}</div></td>
            <td>{{ virtue.virtuelevel|dots:universe_attributes.virtuelevel.max }}</td>
          </tr>
          <tr>
            <td>{{ virtue.virtueboost|squares:universe_attributes.virtueboost.max }}</td>
          </tr>

        {% empty %}

          <tr>
            <td class="fullwidth emptymessage">No virtues</td>
          </tr>

        {% endfor %}

      </table>

    {% endif %}

  </div>

  <div class="clear">&nbsp;</div>

</div>

<div>

  <div class="threecolumnleft">

    <div id="movement">

      <h2 class="sectionheader">Movement</h2>

      <table class="fullwidth">

        <tr>

          <td class="lightunderline textcenter">
            {% if editmode %}
              <input type="text" name="move" value="{{ attributes.move }}" class="statfield" />
            {% else %}
              {{ attributes.move }}
            {% endif %}
          </td>

          <td class="lightunderline textcenter">
            {% if editmode %}
              <input type="text" name="dash" value="{{ attributes.dash }}" class="statfield" />
            {% else %}
              {{ attributes.dash }}
            {% endif %}
          </td>

          <td class="lightunderline textcenter">
            {% if editmode %}
              <input type="text" name="jump" value="{{ attributes.jump }}" class="statfield" />
            {% else %}
              {{ attributes.dash }}
            {% endif %}
          </td>

        </tr>

        <tr>

          <td class="textcenter">
            <label for="move">{{ universe_attributes.move.name }}</label>
          </td>

          <td class="textcenter">
            <label for="dash">{{ universe_attributes.dash.name }}</label>
          </td>

          <td class="textcenter">
            <label for="jump">{{ universe_attributes.jump.name }}</label>
          </td>

        </tr>

      </table>

    </div>

    <div id="soak">

      <h2 class="sectionheader">Soak</h2>

      <table class="fullwidth">

        <tr>

          <td>B</td>
          <td class="soakfield lightunderline textcenter">
            {% if editmode %}
              <input type="text" name="soakbashing" value="{{ attributes.soakbashing }}" class="statfield" />
            {% else %}
              {{ attributes.soakbashing }}
            {% endif %}
          </td>

          <td>L</td>
          <td class="soakfield lightunderline textcenter">
            {% if editmode %}
              <input type="text" name="soaklethal" value="{{ attributes.soaklethal }}" class="statfield" />
            {% else %}
              {{ attributes.soaklethal }}
            {% endif %}
          </td>

          <td>A</td>
          <td class="soakfield lightunderline textcenter">
            {% if editmode %}
              <input type="text" name="soakaggravated" value="{{ attributes.soakaggravated }}" class="statfield" />
            {% else %}
              {{ attributes.soakaggravated }}
            {% endif %}
          </td>

        </tr>

      </table>

    </div>

    <div id="armor">

      <h2 class="sectionheader">{{ universe_attributes.armor.name }}</h2>

      <table class="fullwidth">

        <tr>

          <td class="lightunderline textcenter fullwidth" colspan="6">
            {% if editmode %}
              <input type="text" name="armor" value="{{ attributes.armor }}" class="fullwidth" />
            {% else %}
              {{ attributes.armor }}
            {% endif %}
          </td>

        </tr>

        <tr>

          <td>B</td>
          <td class="armorfield lightunderline textcenter">
            {% if editmode %}
              <input type="text" name="armorbashing" value="{{ attributes.armorbashing }}" class="statfield" />
            {% else %}
              {{ attributes.armorbashing }}
            {% endif %}
          </td>
          
          <td>L</td>
          <td class="armorfield lightunderline textcenter">
            {% if editmode %}
              <input type="text" name="armorlethal" value="{{ attributes.armorlethal }}" class="statfield" />
            {% else %}
              {{ attributes.armorlethal }}
            {% endif %}
          </td>

          <td>A</td>
          <td class="armorfield lightunderline textcenter">
            {% if editmode %}
              <input type="text" name="armoraggravated" value="{{ attributes.armoraggravated }}" class="statfield" />
            {% else %}
              {{ attributes.armoraggravated }}
            {% endif %}
          </td>

        </tr>

      </table>

    </div>

  </div>

  <div class="threecolumnmiddle">

    <div id="legend">

      <h2 class="sectionheader">{{ universe_attributes.legend.name }}</h2>

      <table class="tablecenter">

      	<tr>
          <td colspan="4" class="textcenter">
            {% if editmode %}
              {% dotselect "legend" %}
            {% else %}
              {{ attributes.legend.value|dots:universe_attributes.legend.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td colspan="4" class="textcenter">
            {% if editmode %}
              {% dotselect "legendcurrent" "square" %}
            {% else %}
              {{ attributes.legendcurrent.value|squares:universe_attributes.legendcurrent.max }}
            {% endif %}
          </td>
        </tr>

        <tr>
          <td>{{ universe_attributes.legendpoints.name }}</td>
          <td class="legendpointsfield lightunderline textcenter">
            {% if editmode %}
              <input type="text" name="legendpoints" value="{{ attributes.legendpoints|default:"0" }}" class="statfield" />
            {% else %}
              {{ attributes.legendpoints }}
            {% endif %}
          </td>
          <td>|</td>
          <td class="legendpointsfield lightunderline textcenter">
            {% if editmode %}
              <input type="text" name="legendpointsmax" value="{{ attributes.legendpointsmax|default:"0" }}" class="statfield" />
            {% else %}
              {{ attributes.legendpointsmax }}
            {% endif %}
          </td>
        </tr>

      </table>

    </div>

    <div id="experience">

      <h2 class="sectionheader">Experience</h2>

      <table class="fullwidth">

        <tr>

          <td class="lightunderline textcenter">
            {% if editmode %}
              <input type="text" name="experiencetotal" value="{{ attributes.experiencetotal }}" class="statfield" />
            {% else %}
              {{ attributes.experiencetotal }}
            {% endif %}
          </td>

          <td class="lightunderline textcenter">
            {% if editmode %}
              <input type="text" name="experiencespent" value="{{ attributes.experiencespent }}" class="statfield" />
            {% else %}
              {{ attributes.experiencespent }}
            {% endif %}
          </td>

          <td class="lightunderline textcenter">
            {% if editmode %}
              <input type="text" name="experienceremaining" value="{{ attributes.experienceremaining }}" class="statfield" />
            {% else %}
              {{ attributes.experienceremaining }}
            {% endif %}
          </td>

        </tr>

        <tr>

          <td class="textcenter">
            <label for="experiencetotal">{{ universe_attributes.experiencetotal.name }}<label>
          </td>

          <td class="textcenter">
            <label for="experiencespent">{{ universe_attributes.experiencespent.name }}</label>
          </td>

          <td class="textcenter">
            <label for="experienceremaining">{{ universe_attributes.experienceremaining.name }}</label>
          </td>

        </tr>

      </table>

    </div>

  </div>

  <div class="threecolumnright">

    <div id="health">

      <h2 class="sectionheader">Health</h2>

      <table class="tablecenter">

      	<tr>
          <td>0</td>

          <td>
            {% if editmode %}
              {% dotselect "health1" "square" %}
            {% else %}
              {{ attributes.health1|squares:universe_attributes.health1.max }}
            {% endif %}
          </td>

        </tr>

      	<tr>
          <td>-1</td>

          <td>
            {% if editmode %}
              {% dotselect "health2" "square" %}
            {% else %}
              {{ attributes.health2|squares:universe_attributes.health2.max }}
            {% endif %}
          </td>

        </tr>

      	<tr>
          <td>-1</td>

          <td>
            {% if editmode %}
              {% dotselect "health3" "square" %}
            {% else %}
              {{ attributes.health3|squares:universe_attributes.health3.max }}
            {% endif %}
          </td>

        </tr>

      	<tr>
          <td>-2</td>

          <td>
            {% if editmode %}
              {% dotselect "health4" "square" %}
            {% else %}
              {{ attributes.health4|squares:universe_attributes.health4.max }}
            {% endif %}
          </td>

        </tr>

      	<tr>
          <td>-2</td>

          <td>
            {% if editmode %}
              {% dotselect "health5" "square" %}
            {% else %}
              {{ attributes.health5|squares:universe_attributes.health5.max }}
            {% endif %}
          </td>

        </tr>

      	<tr>
          <td>-4</td>

          <td>
            {% if editmode %}
              {% dotselect "health6" "square" %}
            {% else %}
              {{ attributes.health6|squares:universe_attributes.health6.max }}
            {% endif %}
          </td>

        </tr>

      	<tr>
          <td>I</td>

          <td>
            {% if editmode %}
              {% dotselect "health7" "square" %}
            {% else %}
              {{ attributes.health7|squares:universe_attributes.health7.max }}
            {% endif %}
          </td>

        </tr>

      </table>

    </div>

  </div>

  <div class="clear">&nbsp;</div>

</div>

<div id="boons">

  <h2 class="sectionheader">{{ universe_attributes.boons.name }}</h2>

  {% if editmode %}

    <a class="nounderline" href="#" onclick="addFieldRow('#boon0','#boonrows',true); return false;">Add boon</a>

    <table id="boontable">

      <thead>

        <tr>
          <th class="boonname">Name</th>
          <th class="textcenter">Purview</th>
          <th class="textcenter">Rank</th>
          <th class="booneffect">Effect</th>
          <th class="textcenter">Dice Pool</th>
        </tr>

      </thead>

      <tbody id="boonrows">

        {% for num, boon in attributes.boons.items %}

          <tr>

            <td>
              <div class="lightunderline">
                <select name="boonname">
                  <option value="0"></option>
                  {% for choice in universe_attributes.boonname.choices %}
                    <option value="{{ choice.id }}" {% ifequal choice boon.boonname.choice %}selected{% endifequal %}>{{ choice.name }}</option>
                  {% endfor %}
                </select>
              </div>
            </td>

            <td>
              <div class="lightunderline">
                <select name="boonpurview">
                  <option value="0"></option>
                  {% for choice in universe_attributes.boonpurview.choices %}
                    <option value="{{ choice.id }}" {% ifequal choice boon.boonpurview.choice %}selected{% endifequal %}>{{ choice.name }}</option>
                  {% endfor %}
                </select>
              </div>
            </td>

            <td>
              <div class="lightunderline">
                <input type="text" name="boonrank" value="{{ boon.boonrank }}" class="statfield" />
              </div>
            </td>

            <td class="fullwidth">
              <div class="lightunderline">
                <input type="text" name="booneffect" value="{{ boon.booneffect }}" class="fullwidth" />
              </div>
            </td>

            <td>
              <div class="lightunderline">
                <input type="text" name="boondicepool" value="{{ boon.boondicepool }}" class="statfield" />
              </div>
            </td>

            <td class="removerow">
              <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
            </td>

          </tr>

        {% endfor %}

      </tbody>

      <tbody>

        <tr id="boon0">

          <td>
            <div class="lightunderline">
              <select name="boonname">
                <option value="0"></option>
                {% for choice in universe_attributes.boonname.choices %}
                  <option value="{{ choice.id }}">{{ choice.name }}</option>
                {% endfor %}
              </select>
            </div>
          </td>

          <td>
            <div class="lightunderline">
              <select name="boonpurview">
                <option value="0"></option>
                {% for choice in universe_attributes.boonpurview.choices %}
                  <option value="{{ choice.id }}">{{ choice.name }}</option>
                {% endfor %}
              </select>
            </div>
          </td>

          <td>
            <div class="lightunderline">
              <input type="text" name="boonrank" class="statfield" />
            </div>
          </td>

          <td class="fullwidth">
            <div class="lightunderline">
              <input type="text" name="booneffect" class="fullwidth" />
            </div>
          </td>

          <td>
            <div class="lightunderline">
              <input type="text" name="boondicepool" class="statfield" />
            </div>
          </td>

          <td class="removerow">
            <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
          </td>

        </tr>

      </tbody>
    
    </table>

  {% else %}

    <table id="boontable" class="fullwidth">

      {% for num, boon in attributes.boons.items %}

        {% if forloop.first %}

          <tr>
            <th class="boonname">Name</th>
            <th class="textcenter">Purview</th>
            <th class="textcenter">Rank</th>
            <th class="booneffect">Effect</th>
            <th class="textcenter">Dice Pool</th>
          </tr>

        {% endif %}

        <tr>

          <td class="boonname">
            <div class="lightunderline">
              {{ boon.boonname }}
            </div>
          </td>

          <td>
            <div class="lightunderline">
              {{ boon.boonpurview }}
            </div>
          </td>

          <td>
            <div class="lightunderline textcenter">
              {{ boon.boonrank }}
            </div>
          </td>

          <td class="fullwidth">
            <div class="lightunderline">
              {{ boon.booneffect }}
            </div>
          </td>

          <td>
            <div class="lightunderline textcenter">
              {{ boon.boondicepool }}
            </div>
          </td>

        </tr>

      {% empty %}

        <tr>
          <td class="fullwidth emptymessage" colspan="6">No boons</td>
        </tr>

      {% endfor %}

    </table>

  {% endif %}

</div>

<div id="relics">

  <h2 class="sectionheader">{{ universe_attributes.relics.name }}</h2>

  {% if editmode %}

    <a class="nounderline" href="#" onclick="addFieldRow('#relic0','#relicrows',true); return false;">Add relic</a>

    <table id="relictable" class="fullwidth">

      <thead>

        <tr>
          <th class="relicheader">Name</th>
          <th>Rank</th>
          <th class="relicheader">Purviews</th>
          <th class="relicheader">Effect</th>
        </tr>

      </thead>

      <tbody id="relicrows">

        {% for num, relic in attributes.relics.items %}

          <tr>

            <td>
              <div class="lightunderline">
                <input type="text" name="relicname" value="{{ relic.relicname }}" class="fullwidth" />
              </div>
            </td>

            <td>
              <div class="lightunderline textcenter">
                <input type="text" name="relicrank" value="{{ relic.relicrank }}" class="statfield" />
              </div>
            </td>

            <td>
              <div class="lightunderline">
                <input type="text" name="relicpurviews" value="{{ relic.relicpurviews }}" class="fullwidth" />
              </div>
            </td>

            <td>
              <div class="lightunderline">
                <input type="text" name="reliceffect" value="{{ relic.reliceffect }}" class="fullwidth" />
              </div>
            </td>

            <td class="removerow">
              <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
            </td>

          </tr>

        {% endfor %}

      </tbody>

      <tbody>

        <tr id="relic0">

          <td>
            <div class="lightunderline">
              <input type="text" name="relicname" class="fullwidth" />
            </div>
          </td>

          <td>
            <div class="lightunderline textcenter">
              <input type="text" name="relicrank" value="{{ relic.relicrank }}" class="statfield" />
            </div>
          </td>

          <td>
            <div class="lightunderline">
              <input type="text" name="relicpurviews" class="fullwidth" />
            </div>
          </td>

          <td>
            <div class="lightunderline">
              <input type="text" name="reliceffect" class="fullwidth" />
            </div>
          </td>

          <td class="removerow">
            <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
          </td>

        </tr>

      </tbody>

    </table>

  {% else %}

    <table id="relictable" class="fullwidth">

      {% for num, relic in attributes.relics.items %}

        {% if forloop.first %}
          
          <tr>
            <th class="relicheader">Name</th>
            <th>Rank</th>
            <th class="relicheader">Purviews</th>
            <th class="relicheader">Effect</th>
          </tr>

        {% endif %}

        <tr>

          <td>
            <div class="lightunderline">
              {{ relic.relicname }}
            </div>
          </td>

          <td>
            <div class="lightunderline textcenter">
              {{ relic.relicrank }}
            </div>
          </td>

          <td>
            <div class="lightunderline">
              {{ relic.relicpurviews }}
            </div>
          </td>

          <td>
            <div class="lightunderline">
              {{ relic.reliceffect }}
            </div>
          </td>

        </tr>

      {% empty %}

        <tr>
          <td class="fullwidth emptymessage" colspan="4">No relics</td>
        </tr>

      {% endfor %}

    </table>

  {% endif %}

</div>

<div id="knacks">

  <h2 class="sectionheader">{{ universe_attributes.knacks.name }}</h2>

  {% if editmode %}
    
    <a class="nounderline" href="#" onclick="addFieldRow('#knack0','#knackrows',true); moveKnackClear(); return false;">Add knack</a>

    <div id="knackrows">

      {% for num, knack in attributes.knacks.items %}
        <div class="knackitem">
          <div class="lightunderline knackline">
            <select name="knacks">
              <option value="0"></option>
              {% for choice in universe_attributes.knacks.choices %}
                <option value="{{ choice.id }}" {% ifequal choice knack.choice %}selected{% endifequal %}>{{ choice.name }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="removerow">
            <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
          </div>
        </div>
      {% endfor %}

      <div class="knackitem" id="knack0">
        <div class="lightunderline knackline">
          <select name="knacks">
            <option value="0"></option>
            {% for choice in universe_attributes.knacks.choices %}
              <option value="{{ choice.id }}">{{ choice.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="removerow">
          <a class="nounderline" href="#" onclick="$(this).parent().parent().fadeOut(500,function(){$(this).remove()}); return false;">X</a>
        </div>
      </div>

      <div id="knackclear" class="clear">&nbsp;</div>

    </div>

  {% else %}

    <div id="knackrows">

      {% for num, knack in attributes.knacks.items %}

        <div class="knackitem">
          <div class="lightunderline">
            {{ knack.choice.name }}
          </div>
        </div>

      {% empty %}

        <div class="emptymessage">No knacks</div>

      {% endfor %}

      <div class="clear">&nbsp;</div>

    </div>

  {% endif %}

</div>

<div id="creature">

  <h2 class="sectionheader">Creature</h2>

</div>

<div id="follower">

  <h2 class="sectionheader">Follower</h2>

</div>

<div id="guide">

  <h2 class="sectionheader">{{ universe_attributes.guide.name }}</h2>

  {% if editmode %}
    <textarea name="guide" rows="6" class="fullwidth">{{ attributes.guide }}</textarea>
  {% else %}
		{% if attributes.guide %}
			{{ attributes.guide }}
		{% else %}
			<div class="emptymessage">No guide info</div>
		{% endif %}
  {% endif %}

</div>

<div id="history">

  <h2 class="sectionheader">{{ universe_attributes.history.name }}</h2>

  {% if editmode %}
    <textarea name="history" rows="18" class="fullwidth">{{ attributes.history }}</textarea>
  {% else %}
  	{% if attributes.history %}
    	{{ attributes.history }}
		{% else %}
			<div class="emptymessage">No history info</div>
		{% endif %}
  {% endif %}

</div>

<div id="description">
 
  <h2 class="sectionheader">Description</h2>

</div>

{% endblock %}
